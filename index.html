<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Micro Forms</title>
    <!-- Styles -->
    <link rel="stylesheet" href="/micro-forms.css">
    <!-- Polyfills only needed for Firefox and Edge. -->
    <script src="https://unpkg.com/@webcomponents/webcomponentsjs@latest/webcomponents-loader.js"></script>
    <style>
        .card {
            background-color: #ebebeb;
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
            transition: 0.3s;
            padding: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <script type="module" src="./micro-forms.js"></script>
    <script type="module" src="./example.js"></script>

    <mf-example-form></mf-example-form>

    <div id="results"></div>

    <script>
        var resultsDiv = document.getElementById('results');

        window.addEventListener('mf-submit', function (e) {            
            resultsDiv.innerHTML = `<div class="card">${JSON.stringify(e.detail.data)}</div>`;
        })

        window.addEventListener('mf-cancel', function (e) {
            resultsDiv.innerHTML = '';
        })
    </script>
    <!--
    // <script>
    //     let form = document.querySelector('micro-form');

    //     form.setAttribute('def', JSON.stringify({
    //         title: 'Example Form',
    //         id: 'exampleForm',
    //         fields: [
    //             { name: 'firstname', label: 'Firstname', placeholder: 'Enter your firstname.', datalist: 'names', list: 'John|Jack|Joe|Jerry|Jane|Jill', required: true },
    //             { name: 'lastname', label: 'Lastname', placeholder: 'Enter your lastname.', datalist: 'surnames', list: 'Doe|Nimble|Cool|Rice', required: true },
    //             { name: 'birthDate', label: 'Date of Birth', type: 'date', value: new Date(), placeholder: 'Enter your birthdate.', required: true },
    //             { name: 'gender', label: 'Gender', type: 'radiolist', selected: 'male', options: [ { text: 'Male', value: 'male'},  {text: 'Female', value: 'female'}] },
    //             { id: 'maritalSection', type: 'section', hidden: true, children: [
    //                 { name: 'maritalStatus', label: 'Marital Status', type: 'radiolist', selected: 'single', options: [ { text: 'Married', value: 'married'},  {text: 'Single', value: 'single'}] },
    //                 { name: 'maidenName', label: 'Maiden Name', type: 'text' }
    //             ]},                
    //             { name: 'interests', label: 'Interests', type: 'checklist', inline: true, options: [ { text: 'News', value: 'news'},  {text: 'Sports', value: 'sports'}, {text: 'Fashion', value: 'fashion'}] },
    //             { name: 'comments', label: 'Comments', type: 'textarea', placeholder: 'Add any comments' }
    //         ]
    //     }));
    
    //     window.addEventListener('mf-connected', function (e) {
    //         const { api } = e.detail;

    //         api.rendering(({field, el}) => {
    //             if (field.type === 'section') {
    //                 return { el: (html) => html`<div id="maritalSectionWrap" class="card" hidden>${el}</div>` }
    //             }
    //             return { el }
                
    //         });
    //         api.changing(({name, oldValue, newValue}, values) => {
    //             if (name === 'gender') {                    
    //                 document.querySelector('#maritalSection').style.display = 
    //                     (newValue === 'female' ? 'block' : 'none');
    //                 document.querySelector("#maritalSectionWrap").style.display = 
    //                     (newValue === 'female' ? 'block' : 'none');
    //             }
    //         });
    //         api.submitting((values) => {
    //             values.errors = values.errors || {};
    //             if (!values.firstname) {                    
    //                 values.errors['firstname'] = 'Firstname is required!';
    //             }
    //             if (!values.lastname) {
    //                 values.errors['lastname'] = 'Lastname is required!';
    //             }
                
    //             let guy = 'Mr.';
    //             let gal = values['maritalStatus'] === 'married' ? 'Mrs.' : 'Ms.';
    //             let title = values['gender'] === 'male' ? guy : gal;

    //             values['fullname'] = `${title} ${values['firstname'] || ''} ${values['lastname'] || ''}`;

    //             return values;
    //         });
    //         api.validating(({name, value}) => {
    //             if (name === 'firstname') {
    //                 return !value ? 'Firstname is required!' : '';
    //             } else if (name === 'lastname') {
    //                 return !value ? 'Lastname is required!' : ''
    //             }
    //             return '';
    //         });
    //     })

    //     window.addEventListener('mf-cancel', function (e) {
    //         console.log('cancel', e.detail.id, document.getElementById(e.detail.id));
    //         document.getElementById(e.detail.id).reset();
    //     })

    //     window.addEventListener('mf-submit', function (e) {
    //         console.log('submit', e.detail);
    //     })
    // </script>-->

</body>

</html>